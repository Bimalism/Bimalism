<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi Scientific Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
       
        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
        }

        .header h1 {
            color: white;
            font-size: 2rem;
        }

        .add-calculator-btn {
            background-color: #f05454;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin: 10px auto;
            display: block;
            transition: all 0.3s;
        }

        .add-calculator-btn:hover {
            background-color: #ff6b6b;
            transform: scale(1.05);
        }

        .add-calculator-btn:disabled {
            background-color: #555;
            cursor: not-allowed;
            transform: none;
        }

        .calculators-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 20px;
            max-width: 1600px;
            margin: 0 auto;
        }
       
        .calculator-wrapper {
            position: relative;
        }

        .remove-calculator {
            position: absolute;
            top: -10px;
            right: -10px;
            background-color: #f05454;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 10;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .remove-calculator:hover {
            background-color: #ff4444;
        }
       
        .calculator {
            width: 100%;
            background-color: #222831;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            overflow: hidden;
        }
       
        .display {
            background-color: #1a1a2e;
            color: white;
            padding: 25px 20px;
            text-align: right;
            border-bottom: 1px solid #30475e;
        }
       
        .previous-operand {
            font-size: 1.2rem;
            color: #a9a9a9;
            min-height: 24px;
            word-break: break-all;
        }
       
        .current-operand {
            font-size: 2.5rem;
            font-weight: 300;
            min-height: 60px;
            word-break: break-all;
        }
       
        .mode-toggle {
            display: flex;
            justify-content: center;
            padding: 15px;
            background-color: #1a1a2e;
        }
       
        .mode-btn {
            background-color: #30475e;
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
       
        .mode-btn.active {
            background-color: #f05454;
        }
       
        .buttons {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 1px;
            background-color: #30475e;
        }
       
        button {
            border: none;
            padding: 20px 10px;
            font-size: 1.2rem;
            background-color: #30475e;
            color: white;
            cursor: pointer;
            transition: all 0.2s;
        }
       
        button:hover {
            background-color: #3d5775;
        }
       
        button:active {
            background-color: #f05454;
            transform: scale(0.95);
        }
       
        .operator {
            background-color: #405870;
            color: #f05454;
            font-weight: 600;
        }
       
        .operator:hover {
            background-color: #4a657e;
        }
       
        .equals {
            background-color: #f05454;
            color: white;
            font-weight: 600;
            grid-column: span 2;
        }
       
        .equals:hover {
            background-color: #ff6b6b;
        }
       
        .clear, .delete {
            background-color: #3a506b;
        }
       
        .clear:hover, .delete:hover {
            background-color: #465d7a;
        }
       
        .scientific {
            display: none;
        }
       
        .scientific.show {
            display: block;
        }
       
        .calculator-title {
            text-align: center;
            color: white;
            padding: 15px 0 5px;
            font-size: 1.5rem;
            background-color: #1a1a2e;
            border-bottom: 1px solid #30475e;
        }
       
        @media (max-width: 480px) {
            .calculators-container {
                grid-template-columns: 1fr;
            }
           
            button {
                padding: 18px 5px;
                font-size: 1.1rem;
            }
           
            .current-operand {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Multi Scientific Calculator</h1>
        <button class="add-calculator-btn" id="add-calculator">+ Add Calculator</button>
        <p style="color: #aaa; font-size: 0.9rem;">Maximum 5 calculators</p>
    </div>

    <div class="calculators-container" id="calculators-container">
        <!-- First calculator will be added here via JavaScript -->
    </div>

    <script>
        const MAX_CALCULATORS = 5;
        const container = document.getElementById('calculators-container');
        const addBtn = document.getElementById('add-calculator');

        function createCalculator() {
            if (container.children.length >= MAX_CALCULATORS) {
                addBtn.disabled = true;
                addBtn.textContent = 'Max 5 Calculators Reached';
                return;
            }

            const wrapper = document.createElement('div');
            wrapper.className = 'calculator-wrapper';

            // Remove button
            const removeBtn = document.createElement('button');
            removeBtn.className = 'remove-calculator';
            removeBtn.textContent = '×';
            removeBtn.onclick = () => {
                wrapper.remove();
                updateAddButton();
            };
            wrapper.appendChild(removeBtn);

            // Calculator HTML
            wrapper.innerHTML += `
                <div class="calculator">
                    <div class="calculator-title">Scientific Calculator</div>
                    <div class="display">
                        <div class="previous-operand"></div>
                        <div class="current-operand">0</div>
                    </div>
                   
                    <div class="mode-toggle">
                        <button class="mode-btn active" data-mode="basic">Basic</button>
                        <button class="mode-btn" data-mode="scientific">Scientific</button>
                    </div>
                   
                    <div class="buttons">
                        <button class="scientific" data-operation="sin">sin</button>
                        <button class="scientific" data-operation="cos">cos</button>
                        <button class="scientific" data-operation="tan">tan</button>
                        <button class="scientific" data-operation="log">log</button>
                        <button class="scientific" data-operation="ln">ln</button>
                       
                        <button class="clear" data-action="clear">C</button>
                        <button class="delete" data-action="delete">DEL</button>
                        <button class="operator" data-operation="%">%</button>
                        <button class="operator" data-operation="÷">÷</button>
                        <button class="operator" data-operation="^">x^y</button>
                       
                        <button data-number="7">7</button>
                        <button data-number="8">8</button>
                        <button data-number="9">9</button>
                        <button class="operator" data-operation="×">×</button>
                        <button class="scientific" data-operation="√">√</button>
                       
                        <button data-number="4">4</button>
                        <button data-number="5">5</button>
                        <button data-number="6">6</button>
                        <button class="operator" data-operation="-">-</button>
                        <button class="scientific" data-operation="π">π</button>
                       
                        <button data-number="1">1</button>
                        <button data-number="2">2</button>
                        <button data-number="3">3</button>
                        <button class="operator" data-operation="+">+</button>
                        <button class="scientific" data-operation="e">e</button>
                       
                        <button data-number="0">0</button>
                        <button data-number=".">.</button>
                        <button class="equals" data-action="equals">=</button>
                    </div>
                </div>
            `;

            container.appendChild(wrapper);

            // Initialize this calculator instance
            initializeCalculator(wrapper.querySelector('.calculator'));
            updateAddButton();
        }

        function updateAddButton() {
            const count = container.children.length;
            addBtn.disabled = count >= MAX_CALCULATORS;
            addBtn.textContent = count >= MAX_CALCULATORS ? 'Max 5 Calculators Reached' : '+ Add Calculator';
        }

        function initializeCalculator(calcElement) {
            // Calculator state (unique per instance)
            let currentOperand = '0';
            let previousOperand = '';
            let operation = undefined;
            let isScientificMode = false;
            let isResultDisplayed = false;

            // DOM elements
            const currentOperandElement = calcElement.querySelector('.current-operand');
            const previousOperandElement = calcElement.querySelector('.previous-operand');
            const scientificButtons = calcElement.querySelectorAll('.scientific');
            const modeBtns = calcElement.querySelectorAll('[data-mode]');
            const buttons = calcElement.querySelectorAll('.buttons button');

            function updateDisplay() {
                currentOperandElement.textContent = currentOperand;
                previousOperandElement.textContent = operation ? `${previousOperand} ${operation}` : previousOperand;
            }

            function appendNumber(number) {
                if (isResultDisplayed) {
                    currentOperand = '';
                    isResultDisplayed = false;
                }
                if (number === '.' && currentOperand.includes('.')) return;
                currentOperand = currentOperand === '0' && number !== '.' ? number : currentOperand + number;
            }

            function chooseOperation(op) {
                if (currentOperand === '') return;
                if (previousOperand !== '' && !isResultDisplayed) compute();
                operation = op;
                previousOperand = currentOperand;
                currentOperand = '';
                isResultDisplayed = false;
            }

            function compute() {
                let computation;
                const prev = parseFloat(previousOperand);
                const current = parseFloat(currentOperand);
                if (isNaN(prev) || isNaN(current)) return;

                switch (operation) {
                    case '+': computation = prev + current; break;
                    case '-': computation = prev - current; break;
                    case '×': computation = prev * current; break;
                    case '÷':
                        if (current === 0) { alert("Cannot divide by zero!"); clear(); return; }
                        computation = prev / current; break;
                    case '%': computation = prev % current; break;
                    case '^': computation = Math.pow(prev, current); break;
                    default: return;
                }

                currentOperand = formatResult(computation);
                operation = undefined;
                previousOperand = '';
                isResultDisplayed = true;
            }

            function performScientificOperation(op) {
                const current = parseFloat(currentOperand);
                if (isNaN(current)) return;

                let computation;
                switch (op) {
                    case 'sin': computation = Math.sin(current * Math.PI / 180); break;
                    case 'cos': computation = Math.cos(current * Math.PI / 180); break;
                    case 'tan': computation = Math.tan(current * Math.PI / 180); break;
                    case 'log':
                        if (current <= 0) { alert("Logarithm undefined for ≤0"); return; }
                        computation = Math.log10(current); break;
                    case 'ln':
                        if (current <= 0) { alert("Natural log undefined for ≤0"); return; }
                        computation = Math.log(current); break;
                    case '√':
                        if (current < 0) { alert("Square root undefined for negative"); return; }
                        computation = Math.sqrt(current); break;
                    case 'π': computation = Math.PI; break;
                    case 'e': computation = Math.E; break;
                    default: return;
                }

                currentOperand = formatResult(computation);
                previousOperand = `${op}(${current})`;
                isResultDisplayed = true;
            }

            function formatResult(number) {
                return Number.isInteger(number) ? number.toString() : parseFloat(number.toFixed(10)).toString();
            }

            function clear() {
                currentOperand = '0';
                previousOperand = '';
                operation = undefined;
                isResultDisplayed = false;
            }

            function deleteLast() {
                currentOperand = currentOperand.length === 1 ? '0' : currentOperand.slice(0, -1);
            }

            function toggleMode(mode) {
                isScientificMode = mode === 'scientific';
                scientificButtons.forEach(btn => btn.classList.toggle('show', isScientificMode));
                modeBtns.forEach(btn => btn.classList.toggle('active', btn.dataset.mode === mode));
            }

            // Event listeners
            buttons.forEach(button => {
                button.addEventListener('click', () => {
                    if (button.hasAttribute('data-number')) {
                        appendNumber(button.dataset.number);
                    } else if (button.hasAttribute('data-operation')) {
                        const op = button.dataset.operation;
                        const sciOps = ['sin', 'cos', 'tan', 'log', 'ln', '√', 'π', 'e'];
                        if (sciOps.includes(op) && isScientificMode) {
                            performScientificOperation(op);
                        } else if (!sciOps.includes(op)) {
                            chooseOperation(op);
                        }
                    } else if (button.hasAttribute('data-action')) {
                        const action = button.dataset.action;
                        if (action === 'clear') clear();
                        else if (action === 'delete') deleteLast();
                        else if (action === 'equals') compute();
                    }
                    updateDisplay();
                });
            });

            modeBtns.forEach(btn => {
                btn.addEventListener('click', () => toggleMode(btn.dataset.mode));
            });

            // Initial display
            updateDisplay();
        }

        // Create first calculator on load
        window.onload = () => {
            createCalculator();
        };

        // Add calculator button
        addBtn.addEventListener('click', createCalculator);
    </script>
</body>
</html>
